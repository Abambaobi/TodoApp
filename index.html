<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo App</title>
    <link rel="stylesheet" href="bootstrap.css" />
    <link rel="stylesheet" href="todo.css" />
  </head>
  <body>
    <div class="container-fluid mycontainer">
      <div class="Mynav row">
        <button id="clear" class="btn btn-dark">CLEAR PAGE</button>
        <input id="text-bar" class="col col-md" type="text" name="" />
        <input id="date" class="col-sm col-md" type="date" name="" />

        <button id="add-todo" class="btn btn-warning" onclick="addTodo()">
          ADD TODO
        </button>
        <button id="delete-todo" class="btn btn-danger">DELETE TODO</button>
        <div class="contentList bg-light text-dark row-sm row-md"></div>
      </div>
    </div>

    <script>
      // MODEL SECTION
      let todo = [];
      let divCollection = [];

      // VIEW SECTION
      function render() {
        const contentList = document.querySelector(".contentList");
        const container = document.querySelector(".container-fluid");
        container.appendChild(contentList);
        // contentList.classList.add("col-sm-6 col-md-6 col-lg-6 col-xl-6");
        contentList.innerHTML = "";
        todo.forEach(function (tod) {
          const checkBox = document.createElement("input");
          checkBox.type = "checkbox";
          checkBox.classList.add("checkBox");
          const childDiv = document.createElement("div");
          childDiv.classList.add("bg-warning");
          // childDiv.classList.add("row-sm row-md row-lg row-xl");
          childDiv.classList.add("childDiv");
          childDiv.id = tod.id;

          childDiv.innerText = tod.name + tod.date;
          childDiv.addEventListener("click", appendedChild);
          const DivContainer = document.createElement("div");
          DivContainer.classList.add("DivContainer");
          const checkContainer = document.createElement("div");
          checkContainer.style = "display:inline";
          checkContainer.append(checkBox);
          DivContainer.append(checkContainer, childDiv);
          contentList.appendChild(DivContainer);

          let clickCount = 0;

          checkBox.onchange = function () {
            switch (clickCount) {
              case 0:
                childDiv.innerText = childDiv.innerText + " " + "(Done)";
                clickCount = 1;
                break;

              case 1:
                childDiv.innerText = tod.name + tod.date;
                clickCount = 0;
                break;
            }
          };
        });
      }

      // CONTROL SECTION
      function addTodo() {
        const text = document.getElementById("text-bar");
        const date = document.getElementById("date");
        const textValue = text.value;
        const dateValue = date.value;
        todo.push({
          name: textValue,
          date: dateValue,
          id: new Date().getTime().toString(),
        });

        render();
      }

      function appendedChild(event) {
        let selectedDiv = event.target;
        let selectedDivId = selectedDiv.id;

        todo.forEach((todo) => {
          if (selectedDivId === todo.id) {
            selectedDiv.Id = "Abamba, Obi";
            todo.id = "Abamba, Obi";

            selectedDiv.classList.add("bg-danger");
            selectedDiv.classList.add("click");

            selectedDiv.onclick = function () {
              selectedDiv.classList.add("selectedDivSecond");
              todo.id = new Date().getTime().toString();
              selectedDiv.id = todo.id;
            };
          }
        });
        const deleteButton = document.getElementById("delete-todo");
        deleteButton.onclick = remove;
        function remove() {
          todo = todo.filter((todo) => {
            if (selectedDiv.Id && todo.id === "Abamba, Obi") {
              alert(`Are you sure you want to delete ${todo.name} ?`);
              // const alertz = document.createElement("div");
              // alertz.innerText = `Are you sure you want to delete ${todo.name} ?`;
              // alertz.role = "alert";
              // thi.alertz.classList.add("alert alert-danger");

              return false;
            } else {
              return true;
            }
          });
          render();
        }
      }
    </script>
  </body>
</html>
